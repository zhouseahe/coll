//   Created by acer on 14-5-20.
extends ../layout
block content
    h1= title
    .username #{session.username}
    .chatting
        ul(id='list')

    input(type="text",id="words" ,name="words")
    a(class='send', href='#') | |  发送
    .button
    a(class='button', href='/') 离开  |
    script.
      $(function () {
          var connection = SingletonWebSocket.getConnection();
          connection.onopen = function () {
              connection.send($(".username").text());
          };
          connection.onerror = function (error) {
              console.log(' connection failed !');
          };
          connection.onmessage = function (message) {
              //var json = JSON.parse(message.data);
              $("#list").html( '<ul> ' + message.data +'</ul> ' + $("#list").html()  );
          };
          $(".send").click(function(){
              connection.send($("#words").val());
              $("#words").val("");
          });

      });